# Cloudflare Deployment Notes

## Hosting mode and current deployment model

**Indicators checked:**

- `wrangler.toml` at repo root: **present**
- `wrangler.jsonc` at repo root: **present**
- `/functions/` directory: **not found**
- Build output directory (`dist/`): **present and generated by `npm run build`**
- `_headers` / `_redirects` files in repo root: **present (copied into `dist/` by build)**

**Conclusion:** This repository is a **static site for Cloudflare Pages** and should deploy from **`dist/`** (not repository root).

## Improvement integrated from Cloudflare deploy log audit

Cloudflare log excerpt showed:

- `pages_build_output_dir:` blank
- `No build command specified. Skipping build step.`
- `Error: Failed to publish your Function. Got error: Unknown internal error occurred.`

To prevent this drift and stabilize PR deploys:

- Set `pages_build_output_dir = "dist"` in Wrangler config.
- Set build command to `npm run build` in Wrangler config.
- Keep deployments static-only (no Pages Functions expected).

## Operational guidance

- In Cloudflare Pages UI, ensure Build command is `npm run build` and Build output directory is `dist`.
- Keep `_headers` and `_redirects` at repo root; build pipeline copies them into `dist/`.
- If a deploy log reports Function publish errors again, verify no `_worker.js` or `/functions` artifacts are emitted into `dist/`.

## Local verification commands

- `npm run build`
- `npm run check:redirects-cloudflare`
- `npm run check:navigation-sim`
- `npm run verify`
