export function escapeHtml(value){return String(value).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#39;");}
function getPath(obj,pathStr){const parts=String(pathStr).split('.').map(s=>s.trim()).filter(Boolean);let cur=obj;for(const p of parts){if(cur==null||!(p in cur)) return undefined;cur=cur[p];}return cur;}
export function render(template,data,{strict=true}={}){const tokenRe=/{{{\s*([^}]+?)\s*}}}|{{\s*([^}{]+?)\s*}}/g;return template.replace(tokenRe,(m,rawKey,escKey)=>{const isRaw=typeof rawKey==='string'&&rawKey.length>0;const key=(rawKey||escKey||'').trim();const v=getPath(data,key);if((v===undefined||v===null)&&strict) throw new Error(`Missing token: ${m}`);const val=v??'';return isRaw?String(val):escapeHtml(val);});}